<!DOCTYPE html>
<html>

<head>
    <title>OpenFoodFacts API Test</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }

        .result {
            background: #2a2a2a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }

        .success {
            color: #22c55e;
        }

        .error {
            color: #ef4444;
        }
    </style>
</head>

<body>
    <h1>Testing Open Food Facts API</h1>

    <h3>Test Known Products:</h3>
    <button onclick="testProduct('3017620422003', 'Nutella (France)')">Nutella (France)</button>
    <button onclick="testProduct('8901063010031', 'Parle-G (India)')">Parle-G (India)</button>
    <button onclick="testProduct('737628064502', 'Oreo (USA)')">Oreo (USA)</button>

    <h3>Search Indian Products:</h3>
    <button onclick="searchIndianProducts()">Search Indian Market</button>

    <div id="results"></div>

    <script>
        async function testProduct(barcode, name) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML += `<div class="result">Testing ${name} (${barcode})...</div>`;

            try {
                const response = await fetch(`https://world.openfoodfacts.org/api/v0/product/${barcode}.json`);
                const data = await response.json();

                if (data.status === 1) {
                    resultsDiv.innerHTML += `<div class="result success">✓ SUCCESS: ${data.product.product_name || 'Unknown'}<br>Brand: ${data.product.brands || 'Unknown'}<br>Barcode: ${barcode}</div>`;
                } else {
                    resultsDiv.innerHTML += `<div class="result error">✗ NOT FOUND: ${barcode}</div>`;
                }
            } catch (error) {
                resultsDiv.innerHTML += `<div class="result error">✗ ERROR: ${error.message}</div>`;
            }
        }

        async function searchIndianProducts() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML += `<div class="result">Searching for Indian products...</div>`;

            try {
                const response = await fetch('https://world.openfoodfacts.org/cgi/search.pl?search_terms=india&countries=india&action=process&json=1&page_size=10');
                const data = await response.json();

                if (data.products && data.products.length > 0) {
                    resultsDiv.innerHTML += `<div class="result success">Found ${data.products.length} Indian products:</div>`;
                    data.products.slice(0, 5).forEach(product => {
                        resultsDiv.innerHTML += `<div class="result">
                            <strong>${product.product_name || 'Unnamed'}</strong><br>
                            Barcode: <code>${product._id || product.code}</code><br>
                            Brand: ${product.brands || 'Unknown'}<br>
                            Grade: ${product.nutrition_grades || 'N/A'}
                        </div>`;
                    });
                } else {
                    resultsDiv.innerHTML += `<div class="result error">No products found</div>`;
                }
            } catch (error) {
                resultsDiv.innerHTML += `<div class="result error">ERROR: ${error.message}</div>`;
            }
        }
    </script>
</body>

</html>